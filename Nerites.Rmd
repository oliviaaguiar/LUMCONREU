---
title: "Nerites"
author: "Olivia Aguiar"
date: "7/26/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(Biostatistics)
library(readxl)
library(plotrix)
snail <- read_xlsx('Snail_Density_Seasons.xlsx')
```

#cleaning
```{r}
snail$date <- gsub('2017/01', '01/2017', snail$date)
snail$date <- gsub('2017/02', '02/2017', snail$date)
snail$date <- gsub('2017/03', '03/2017', snail$date)
snail$date <- gsub('2017/04', '04/2017', snail$date)
snail$date <- gsub('2017/05', '05/2017', snail$date)
snail$date <- gsub('2017/06', '06/2017', snail$date)
snail$date <- gsub('2017/07', '07/2017', snail$date)
snail$date <- gsub('2017/08', '08/2017', snail$date)
snail$date <- gsub('2017/09', '09/2017', snail$date)
snail$date <- gsub('2017/10', '10/2017', snail$date)
snail$date <- gsub('2017/11', '11/2017', snail$date)
snail$date <- gsub('2017/12', '12/2017', snail$date)

snail$date <- gsub('2018/01', '01/2018', snail$date)
snail$date <- gsub('2018/02', '02/2018', snail$date)
snail$date <- gsub('2018/03', '03/2018', snail$date)
snail$date <- gsub('2018/04', '04/2018', snail$date)
snail$date <- gsub('2018/05', '05/2018', snail$date)
snail$date <- gsub('2018/06', '06/2018', snail$date)
snail$date <- gsub('2018/07', '07/2018', snail$date)
snail$date <- gsub('2018/08', '08/2018', snail$date)
snail$date <- gsub('2018/09', '09/2018', snail$date)
snail$date <- gsub('2018/10', '10/2018', snail$date)
snail$date <- gsub('2018/11', '11/2018', snail$date)
snail$date <- gsub('2018/12', '12/2018', snail$date)

snail$date <- gsub('2019/01', '01/2019', snail$date)
snail$date <- gsub('2019/02', '02/2019', snail$date)
snail$date <- gsub('2019/03', '03/2019', snail$date)
snail$date <- gsub('2019/04', '04/2019', snail$date)
snail$date <- gsub('2019/05', '05/2019', snail$date)
snail$date <- gsub('2019/06', '06/2019', snail$date)
snail$date <- gsub('2019/07', '07/2019', snail$date)
snail$date <- gsub('2019/08', '08/2019', snail$date)
snail$date <- gsub('2019/09', '09/2019', snail$date)
snail$date <- gsub('2019/10', '10/2019', snail$date)
snail$date <- gsub('2019/11', '11/2019', snail$date)
snail$date <- gsub('2019/12', '12/2019', snail$date)

snail$date <- gsub('2020/01', '01/2020', snail$date)
snail$date <- gsub('2020/02', '02/2020', snail$date)
snail$date <- gsub('2020/03', '03/2020', snail$date)
snail$date <- gsub('2020/04', '04/2020', snail$date)
snail$date <- gsub('2020/05', '05/2020', snail$date)
snail$date <- gsub('2020/06', '06/2020', snail$date)
snail$date <- gsub('2020/07', '07/2020', snail$date)
snail$date <- gsub('2020/08', '08/2020', snail$date)
snail$date <- gsub('2020/09', '09/2020', snail$date)
snail$date <- gsub('2020/10', '10/2020', snail$date)
snail$date <- gsub('2020/11', '11/2020', snail$date)
snail$date <- gsub('2020/12', '12/2020', snail$date)

snail$date <- gsub('2021/01', '01/2021', snail$date)
snail$date <- gsub('2021/02', '02/2021', snail$date)
snail$date <- gsub('2021/03', '03/2021', snail$date)
snail$date <- gsub('2021/04', '04/2021', snail$date)
```

```{r}
average <- snail %>% 
  group_by(date) %>% 
  summarise(mean = mean(Nu_density_m2),
            SE = std.error(Nu_density_m2))
```

#graphs
```{r}
snail %>% ggplot() + geom_boxplot(aes(x = date, y = Nu_density_m2))
#messy

average %>% ggplot(aes(x=date, y=mean)) + geom_point(aes(x=date, y=mean)) + geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE)) + xlab('Date') + ylab('Nerite Density') + theme(axis.text.x = element_text(size = 7, angle = 45), axis.ticks = element_blank()) + scale_x_discrete(limits = c('01/2017', '02/2017', '03/2017', '04/2017', '05/2017', '06/2017', '07/2017', '08/2017', '09/2017', '10/2017', '11/2017', '12/2017', '01/2018', '02/2018', '03/2018', '04/2018', '05/2018', '06/2018', '07/2018', '08/2018', '09/2018', '10/2018', '11/2018', '12/2018', '01/2019', '02/2019', '03/2019', '04/2019', '05/2019', '06/2019', '07/2019', '08/2019', '09/2019', '10/2019', '11/2019', '12/2019', '01/2020', '02/2020', '03/2020', '04/2020', '05/2020', '06/2020', '07/2020', '08/2020', '09/2020', '10/2020', '11/2020', '12/2020', '01/2021', '02/2021', '03/2021', '04/2021'))
```

#does nucella density vary by site?
```{r}
nu.aov <- aov(Nu_density_m2 ~ site, snail)
summary(nu.aov)
TukeyHSD(nu.aov)
#LUM2 significantly greater than other sites- very large outlier though

snail %>% ggplot() + geom_boxplot(aes(x=site, y=Nu_density_m2)) + xlab('Site') + ylab('Nerite Density')
```

