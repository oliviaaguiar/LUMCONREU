---
title: "Snail Visualization"
author: "Olivia Aguiar"
date: "6/30/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(tidyverse)
library(Biostatistics)
library(readxl)
```

#load data
```{r}
snail <- read_xlsx('LUMSnails_Density_Master.xlsx')
```

#boxplot by season
```{r}
#periwinkles
snail %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab("Season") + ylab("Littoraria Density")
```

#anova by season
```{r}
lit.aov.sea <- aov(snail$Li_density_m2 ~ snail$season)
summary(lit.aov.sea)
#p=0.283
```

#boxplot by site
```{r}
#periwinkles
snail %>% ggplot() +
  geom_boxplot(aes(x=site, y=Li_density_m2)) + xlab('Site') + ylab('Littoraria Density')
```

#anova by site
```{r}
#periwinkles
lit.aov.site <- aov(snail$Li_density_m2 ~ snail$site)
summary(lit.aov.site)
#p<2e-16
```

#since grouping them all together doesn't reveal any relationship, but there are differences in density between sites, I'm going to separate the sites to see if there is any seasonality when they aren't grouped together

#making data frame for each sites
```{r}
LUM1 <- snail %>% filter(site == 'LUM1')
LUM2 <- snail %>% filter(site == 'LUM2')
LUM3 <- snail %>% filter(site == 'LUM3')
```

#looking at seasons again (periwinkles)
```{r}
##LUM1
LUM1 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density')
LUM1.aov.season <- aov(LUM1$Li_density_m2 ~ LUM1$season)
summary(LUM1.aov.season)
#p=0.406

##LUM2
LUM2 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density')
LUM2.aov.season <- aov(LUM2$Li_density_m2 ~ LUM2$season)
summary(LUM2.aov.season)
#p=0.122

##LUM3
LUM3 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density')
LUM3.aov.season <- aov(LUM3$Li_density_m2 ~ LUM3$season)
summary(LUM3.aov.season)
#p=0.922
```

#plot by month
```{r}
level_order <- c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec')

snail %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density')

#LUM1
LUM1 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density')

#LUM2
LUM2 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density')

#LUM3
LUM3 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density')
#looks like theres a pattern?
LUM3.aov.month <- aov(LUM3$Li_density_m2 ~ LUM3$month_name)
summary(LUM3.aov.month)
#p=0.469
```

