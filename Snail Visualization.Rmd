---
title: "Snail Visualization"
author: "Olivia Aguiar"
date: "6/30/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(tidyverse)
library(Biostatistics)
library(readxl)
```

#load data
```{r}
snail <- read_xlsx('LUMSnails_Density_Master.xlsx')
```

#boxplot by season
```{r}
#periwinkles
snail %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab("Season") + ylab("Littoraria Density")
```

#anova by season
```{r}
lit.aov.sea <- aov(snail$Li_density_m2 ~ snail$season)
summary(lit.aov.sea)
#p=0.283
```

#boxplot by site
```{r}
#periwinkles
snail %>% ggplot() +
  geom_boxplot(aes(x=site, y=Li_density_m2)) + xlab('Site') + ylab('Littoraria Density')
```

#anova by site
```{r}
#periwinkles
lit.aov.site <- aov(snail$Li_density_m2 ~ snail$site)
summary(lit.aov.site)
#p<2e-16
TukeyHSD(lit.aov.site)
#they are all differnet from each other
```

#since grouping them all together doesn't reveal any relationship, but there are differences in density between sites, I'm going to separate the sites to see if there is any seasonality when they aren't grouped together

#making data frame for each sites
```{r}
LUM1 <- snail %>% filter(site == 'LUM1')
LUM2 <- snail %>% filter(site == 'LUM2')
LUM3 <- snail %>% filter(site == 'LUM3')
```

#looking at seasons again (periwinkles)
```{r}
##LUM1
LUM1 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle("LUM1")
LUM1.aov.season <- aov(LUM1$Li_density_m2 ~ LUM1$season)
summary(LUM1.aov.season)
#p=0.406

##LUM2
LUM2 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM2')
LUM2.aov.season <- aov(LUM2$Li_density_m2 ~ LUM2$season)
summary(LUM2.aov.season)
#p=0.122

##LUM3
LUM3 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM3')
LUM3.aov.season <- aov(LUM3$Li_density_m2 ~ LUM3$season)
summary(LUM3.aov.season)
#p=0.922
```

#plot by month
```{r}
level_order <- c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec')

snail %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density')

#LUM1
LUM1 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM1')

#LUM2
LUM2 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM2')

#LUM3
LUM3 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM3')
#looks like theres a pattern?
LUM3.aov.month <- aov(LUM3$Li_density_m2 ~ LUM3$month_name)
summary(LUM3.aov.month)
#p=0.469
```

#separating into each year and sites

###LUM1 by month
```{r}
#2017
LUM1.17 <- LUM1 %>% filter(year == 2017)
LUM1.17 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2017')
LUM1.17.aov <- aov(LUM1.17$Li_density_m2 ~ LUM1.17$month_name)
summary(LUM1.17.aov)
#June 2017 TS Cindy, no difference- August 2017 Hurricane Harvey, looks like a small dip- October 2017 Hurricane Nate, small dip

#2018
LUM1.18 <- LUM1 %>% filter(year == 2018)
LUM1.18 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2018')
LUM1.18.aov <- aov(LUM1.18$Li_density_m2 ~ LUM1.18$month_name)
summary(LUM1.18.aov)

#2019
LUM1.19 <- LUM1 %>% filter(year == 2019)
LUM1.19 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2019')
LUM1.19.aov <- aov(LUM1.19$Li_density_m2 ~ LUM1.19$month_name)
summary(LUM1.19.aov)
#July 2019 Hurricane Barry, small dip- October 2019 TS Olga, big dip

#2020
LUM1.20 <- LUM1 %>% filter(year == 2020)
LUM1.20 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2020')
LUM1.20.aov <- aov(LUM1.20$Li_density_m2 ~ LUM1.20$month_name)
summary(LUM1.20.aov)
#June 2020 TS Cristobal, very low that month- August 2020 Hurricane Marco, increase afterwards- October 2020 Hurricane Delta and Zeta, increase afterwards

#2021
LUM1.21 <- LUM1 %>% filter(year == 2021)
LUM1.21_level_order <- c('Jan', 'Feb', 'Mar', 'Apr')
LUM1.21 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = LUM1.21_level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2021')
LUM1.21.aov <- aov(LUM1.21$Li_density_m2 ~ LUM1.21$month_name)
summary(LUM1.21.aov)

###none of these are significant
```

###LUM1 by season
```{r}
#2017
LUM1.17 <- LUM1 %>% filter(year == 2017)
LUM1.17 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2017')
LUM1.17.aov <- aov(LUM1.17$Li_density_m2 ~ LUM1.17$season)
summary(LUM1.17.aov)
###all are about the same here

#2018
LUM1.18 <- LUM1 %>% filter(year == 2018)
LUM1.18 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2018')
LUM1.18.aov <- aov(LUM1.18$Li_density_m2 ~ LUM1.18$season)
summary(LUM1.18.aov)
###says it isn't significant but fall looks a lot higher than the other seasons

#2019
LUM1.19 <- LUM1 %>% filter(year == 2019)
LUM1.19 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2019')
LUM1.19.aov <- aov(LUM1.19$Li_density_m2 ~ LUM1.19$season)
summary(LUM1.19.aov)
###fall looks a little higher, winter a little lower but boxes overlap- no significance

#2020
LUM1.20 <- LUM1 %>% filter(year == 2020)
LUM1.20 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2020')
LUM1.20.aov <- aov(LUM1.20$Li_density_m2 ~ LUM1.20$season)
summary(LUM1.20.aov)
###looks higher in fall and winter- no significance


#2021
LUM1.21 <- LUM1 %>% filter(year == 2021)
LUM1.21 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM1 Density in 2021')
LUM1.21.aov <- aov(LUM1.21$Li_density_m2 ~ LUM1.21$season)
summary(LUM1.21.aov)
```

###LUM2 by month
```{r}
#2017
LUM2.17 <- LUM2 %>% filter(year == 2017)
LUM2.17 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2017')
LUM2.17.aov <- aov(LUM2.17$Li_density_m2 ~ LUM2.17$month_name)
summary(LUM2.17.aov)
#increases around July to November
#June 2017 TS Cindy, increase afterwards- August 2017 Hurricane Harvey, tiny decrease- October 2017 Hurricane Nate, tiny decrease

#2018
LUM2.18 <- LUM2 %>% filter(year == 2018)
LUM2.18 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2018')
LUM2.18.aov <- aov(LUM2.18$Li_density_m2 ~ LUM2.18$month_name)
summary(LUM2.18.aov)
#peak in October-November

#2019
LUM2.19 <- LUM2 %>% filter(year == 2019)
LUM2.19 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2019')
LUM2.19.aov <- aov(LUM2.19$Li_density_m2 ~ LUM2.19$month_name)
summary(LUM2.19.aov)
#all over the place
#July 2019 Hurricane Barry, big decrease- October 2019 TS Olga, very low that whole month


#2020
LUM2.20 <- LUM2 %>% filter(year == 2020)
LUM2.20 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2020')
LUM2.20.aov <- aov(LUM2.20$Li_density_m2 ~ LUM2.20$month_name)
summary(LUM2.20.aov)
TukeyHSD(LUM2.20.aov)
#October-May, September-May, May-Jan, sort of for february, feb-apr, 
#June 2020 TS Cristobal, very low that month- August 2020 Hurricane Marco, decrease afterwards- October 2020 Hurricane Delta and Zeta, small increase afterwards


#2021
LUM2.21 <- LUM2 %>% filter(year == 2021)
LUM2.21_level_order <- c('Jan', 'Feb', 'Mar', 'Apr')
LUM2.21 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = LUM2.21_level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2021')
LUM2.21.aov <- aov(LUM2.21$Li_density_m2 ~ LUM2.21$month_name)
summary(LUM2.21.aov)
```
 

###LUM2 by season
```{r}
#2017
LUM2.17 <- LUM2 %>% filter(year == 2017)
LUM2.17 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2017')
LUM2.17.aov <- aov(LUM2.17$Li_density_m2 ~ LUM2.17$season)
summary(LUM2.17.aov)
#winter lower than other months- no sig

#2018
LUM2.18 <- LUM2 %>% filter(year == 2018)
LUM2.18 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2018')
LUM2.18.aov <- aov(LUM2.18$Li_density_m2 ~ LUM2.18$season)
summary(LUM2.18.aov)
#Fall higher than other months- sig

#2019
LUM2.19 <- LUM2 %>% filter(year == 2019)
LUM2.19 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2019')
LUM2.19.aov <- aov(LUM2.19$Li_density_m2 ~ LUM2.19$season)
summary(LUM2.19.aov)
#decreasing during summer and winter- no sig

#2020
LUM2.20 <- LUM2 %>% filter(year == 2020)
LUM2.20 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2020')
LUM2.20.aov <- aov(LUM2.20$Li_density_m2 ~ LUM2.20$season)
summary(LUM2.20.aov)
TukeyHSD(LUM2.20.aov)
#Winter higher than fall, spring higher than fall (little over significance)

#2021
LUM2.21 <- LUM2 %>% filter(year == 2021)
LUM2.21 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM2 Density in 2021')
LUM2.21.aov <- aov(LUM2.21$Li_density_m2 ~ LUM2.21$season)
summary(LUM2.21.aov)
#spring and winter very close
```


###LUM3 by month
```{r}
#2017
LUM3.17 <- LUM3 %>% filter(year == 2017)
LUM3.17 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2017')
LUM3.17.aov <- aov(LUM3.17$Li_density_m2 ~ LUM3.17$month_name)
summary(LUM3.17.aov)
#all over the place- no sig
#June 2017 TS Cindy, low that month- August 2017 Hurricane Harvey, large decrease- October 2017 Hurricane Nate, large decrease


#2018
LUM3.18 <- LUM3 %>% filter(year == 2018)
LUM3.18 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2018')
LUM3.18.aov <- aov(LUM3.18$Li_density_m2 ~ LUM3.18$month_name)
summary(LUM3.18.aov)
#aside from january it looks like it peaks June-November- no sig

#2019
LUM3.19 <- LUM3 %>% filter(year == 2019)
LUM3.19 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2019')
LUM2.19.aov <- aov(LUM2.19$Li_density_m2 ~ LUM2.19$month_name)
summary(LUM2.19.aov)
#drop in density after May/June- low in July then builds back up- no sig
#July 2019 Hurricane Barry, low that month- October 2019 TS Olga, increase afterwards


#2020
LUM3.20 <- LUM3 %>% filter(year == 2020)
LUM3.20 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2020')
LUM3.20.aov <- aov(LUM3.20$Li_density_m2 ~ LUM3.20$month_name)
summary(LUM3.20.aov)
#drops during october/november besides that very random- no sig
#June 2020 TS Cristobal, very low that month- August 2020 Hurricane Marco, tiny afterwards- October 2020 Hurricane Delta and Zeta, low that month and november


#2021
LUM3.21 <- LUM3 %>% filter(year == 2021)
LUM3.21_level_order <- c('Jan', 'Feb', 'Mar', 'Apr')
LUM3.21 %>% ggplot() +
  geom_boxplot(aes(x=factor(month_name, levels = LUM3.21_level_order), y=Li_density_m2)) + xlab('Month') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2021')
LUM3.21.aov <- aov(LUM3.21$Li_density_m2 ~ LUM3.21$month_name)
summary(LUM3.21.aov)
#january looks lower than the others- no sig
```


###LUM3 by season
```{r}
#2017
LUM3.17 <- LUM3 %>% filter(year == 2017)
LUM3.17 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2017')
LUM3.17.aov <- aov(LUM3.17$Li_density_m2 ~ LUM3.17$season)
summary(LUM3.17.aov)
#fall looks a little lower than other months- no sig

#2018
LUM3.18 <- LUM3 %>% filter(year == 2018)
LUM3.18 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2018')
LUM3.18.aov <- aov(LUM3.18$Li_density_m2 ~ LUM3.18$season)
summary(LUM3.18.aov)
#fall looks a little higher- no sig

#2019
LUM3.19 <- LUM3 %>% filter(year == 2019)
LUM3.19 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2019')
LUM3.19.aov <- aov(LUM3.19$Li_density_m2 ~ LUM3.19$season)
summary(LUM3.19.aov)
#all look pretty similar- summer lower than the rest- no sig

#2020
LUM3.20 <- LUM3 %>% filter(year == 2020)
LUM3.20 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2020')
LUM3.20.aov <- aov(LUM3.20$Li_density_m2 ~ LUM3.20$season)
summary(LUM3.20.aov)

#2021
LUM3.21 <- LUM3 %>% filter(year == 2021)
LUM3.21 %>% ggplot() +
  geom_boxplot(aes(x=season, y=Li_density_m2)) + xlab('Season') + ylab('Littoraria density') + ggtitle('LUM3 Density in 2021')
LUM3.21.aov <- aov(LUM3.21$Li_density_m2 ~ LUM3.21$season)
summary(LUM3.21.aov)
```

